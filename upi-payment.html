<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UPI Payment</title>
  <link rel="stylesheet" href="styles/components.css">
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; text-align: center; }
    .upi-box { border: 1px solid #ddd; padding: 20px; border-radius: 10px; display: inline-block; }
    .btn { display: block; margin-top: 15px; background: #28a745; color: #fff; padding: 10px 20px; text-decoration: none; border-radius: 5px; }
    img { margin-top: 15px; }
  </style>
</head>
<body>
  <h2>UPI Payment</h2>
  <div class="upi-box">
    <p id="payAmount"></p>
    <img id="upiQR" alt="UPI QR Code" />
    <a id="upiLink" class="btn">Pay with UPI App</a>
  </div>

  <script>
    let total = localStorage.getItem("cartTotal") || 0;
    document.getElementById("payAmount").innerText = "Payable Amount: ₹" + total;

    // Replace with your actual UPI details
    let upiId = "merchant@upi";  
    let name = "Merchant Name";

    // UPI deep link
    let upiUrl = `upi://pay?pa=${upiId}&pn=${encodeURIComponent(name)}&am=${total}&cu=INR`;

    // Set UPI link for app redirect
    document.getElementById("upiLink").setAttribute("href", upiUrl);

    // Generate QR dynamically using external API
    let qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(upiUrl)}`;
    document.getElementById("upiQR").setAttribute("src", qrUrl);

    // After clicking, clear cart (simulate success)
    document.getElementById("upiLink").addEventListener("click", () => {
      setTimeout(() => {
        alert("Redirecting to UPI app for payment of ₹" + total);
        localStorage.removeItem("cartItems");
        localStorage.removeItem("cartTotal");
      }, 500);
    });
  </script>
</body>
</html>
